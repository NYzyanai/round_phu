<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Round Phu</title>
    <style>
    	* { padding: 0; margin: 0; }
    	canvas { background: #eee; display: block; margin: 0 auto; }
    </style>
</head>
<body>

<canvas id="myCanvas" width="480" height="320"></canvas>

<script>
// JavaScriptのコードがここに入ります

//素材読み込み
var phu1= new Image();
phu1.src ="resources/phu/1.PNG";

var bg1 = new Image();
bg1.src ="resources/countryside/1.PNG";
var bg2 = new Image();
bg2.src ="resources/countryside/2.PNG";
var bg3 = new Image();
bg3.src ="resources/countryside/3.PNG";
var bg4 = new Image();
bg4.src ="resources/countryside/4.PNG";
var bg5 = new Image();
bg5.src ="resources/countryside/5.PNG";


//お決まりの2列
var canvas = document.getElementById("myCanvas");
var ctx = canvas.getContext("2d");

//表示する場所を動かせるようにする
var x = 200;
var y = 100; //下から70マス上

//動かす
var dx =0;
var dy =0;

//Phuの大きさ決定
var phuH=200;
var phuW=300;

//キー初期化
var rightPressed = false;
var leftPressed = false;
var upPressed=false;

//ここからdraw
function draw(){

  clearCanvas();
  drawbackground();
  x=x+dx;
  y=y+dy;

  drawphu();


  if(rightPressed){
    dx=1/2;
  }else if(leftPressed){
    dx=-1/2;
  }else{
    dx=0;
  }
  x=x+dx;
  /*キーが押されていないときは常に重力発生、 
  ただし地面にはめり込まない*/

  if(upPressed){
    y=y-1;
  }else if(y<=canvas.height-180){
    y=y+1;
  }
  //うごかすよー


}

//トリリアン描画関数
function drawphu(){
  ctx.drawImage(phu1,x,y,phuW,phuH);
}

//背景描画関数
function drawbackground(){
  ctx.drawImage(bg1,0,0,canvas.width, canvas.height);
  ctx.drawImage(bg2,0,0,canvas.width, canvas.height);
  ctx.drawImage(bg3,0,0,canvas.width, canvas.height);
  ctx.drawImage(bg4,0,0,canvas.width, canvas.height);
  ctx.drawImage(bg5,0,0,canvas.width, canvas.height);
}

//キャンバス消す関数
function clearCanvas(){
  ctx.clearRect(0, 0, canvas.width, canvas.height);
}

//キー判定関数
function key(){
  if(rightPressed){
    dx=1;
  }else if(leftPressed){
    dx=-1;
  }else{
    dx=0;
  }

  //キーが押されていないときは常に重力発生、 
  //ただし地面にはめり込まない

  if(upPressed){
    y=y-3;
  }else if(y<=canvas.height-triH){
    y=y+2;
  }
}


//キーイベント読み込みはじめ
document.addEventListener("keydown",keyDownHandler, false);
document.addEventListener("keyup", keyUpHandler, false);

function keyDownHandler(e) {
    if(e.key == "Right" || e.key == "ArrowRight") {
        rightPressed = true;
    }
    else if(e.key == "Left" || e.key == "ArrowLeft") {
        leftPressed = true;
    }
    else if(e.key == "Up" || e.key == "ArrowUp") {
        upPressed = true;
    }
}

function keyUpHandler(e) {
    if(e.key == "Right" || e.key == "ArrowRight") {
        rightPressed = false;
    }
    else if(e.key == "Left" || e.key == "ArrowLeft") {
        leftPressed = false;
    }
    else if(e.key == "Up" || e.key == "ArrowUp") {
        upPressed= false;
    }
}
//キーイベント読み込み終わり

//10ミリ秒ごとに描画する
setInterval(draw, 10);


/*もし壁の外にいくんだったら、で「||」だと条件指定がorになる。
  if(y+dy<0 || y+dy>canvas.height-triH){
    dy=-dy;　//増やしていく数値を反転させる
   }
  if(x+dx<0|| x+dx>canvas.width-triW){
    dx=-dx; //増やしていく数値を反転させる
  }
*/



</script>

</body>
</html>